<div class="dashboard-container fade-in">
  @if (isLoading()) {
    <div class="loading-state">
      <mat-spinner diameter="50"></mat-spinner>
      <p>טוען נתונים...</p>
    </div>
  } @else {
    <!-- Welcome Header -->
    <header class="dashboard-header slide-down">
      <div class="header-content">
        <h1>
          <span>{{ getGreeting() }},</span>
          <span class="highlight-name">{{ currentUser()?.name || 'משתמש' }}</span>
        </h1>
        <p>סקירה מהירה של המשימות והפרויקטים שלך</p>
      </div>
      <div class="header-actions">
        <button mat-flat-button color="primary" [routerLink]="['/tasks']">
          <mat-icon>add</mat-icon> משימה חדשה
        </button>
      </div>
    </header>

    <!-- Stats Overview -->
    <section class="stats-overview">
      <div class="stat-card tasks-total slide-up" style="animation-delay: 0.1s">
        <div class="stat-icon">
          <mat-icon>assignment</mat-icon>
        </div>
        <div class="stat-info">
          <span class="value">{{ totalTasks() }}</span>
          <span class="label">סה"כ משימות</span>
        </div>
      </div>

      <div class="stat-card tasks-completed slide-up" style="animation-delay: 0.2s">
        <div class="stat-icon">
          <mat-icon>check_circle</mat-icon>
        </div>
        <div class="stat-info">
          <span class="value">{{ completedTasks() }}</span>
          <span class="label">הושלמו</span>
        </div>
      </div>

      <div class="stat-card tasks-active slide-up" style="animation-delay: 0.3s">
        <div class="stat-icon">
          <mat-icon>schedule</mat-icon>
        </div>
        <div class="stat-info">
          <span class="value">{{ inProgressTasks() }}</span>
          <span class="label">בביצוע</span>
        </div>
      </div>

      <div class="stat-card projects-total slide-up" style="animation-delay: 0.4s">
        <div class="stat-icon">
          <mat-icon>folder</mat-icon>
        </div>
        <div class="stat-info">
          <span class="value">{{ totalProjects() }}</span>
          <span class="label">פרויקטים</span>
        </div>
      </div>
    </section>

    <div class="content-grid">
      <!-- Recent Tasks List -->
      <mat-card class="content-card slide-up" style="animation-delay: 0.5s">
        <div class="card-header">
          <h2>משימות אחרונות</h2>
          <button mat-button color="primary" [routerLink]="['/tasks']">
            ראה הכל
            <mat-icon iconPositionEnd>arrow_back</mat-icon>
          </button>
        </div>
        <mat-card-content>
          @if (recentTasks().length > 0) {
            <div class="tasks-list">
              @for (task of recentTasks(); track task.id) {
                <div class="task-item">
                  <div class="task-status-indicator" [class]="task.status"></div>
                  <div class="task-details">
                    <span class="task-title">{{ task.title }}</span>
                    <span class="task-meta">{{ task.description || 'אין תיאור' }}</span>
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-state">
              <mat-icon>assignment_turned_in</mat-icon>
              <p>אין משימות פעילות כרגע</p>
            </div>
          }
        </mat-card-content>
      </mat-card>

      <!-- Recent Projects List -->
      <mat-card class="content-card slide-up" style="animation-delay: 0.6s">
        <div class="card-header">
          <h2>פרויקטים אחרונים</h2>
          <button mat-button color="primary" [routerLink]="['/projects']">
            ראה הכל
            <mat-icon iconPositionEnd>arrow_back</mat-icon>
          </button>
        </div>
        <mat-card-content>
          @if (recentProjects().length > 0) {
            <div class="projects-list">
              @for (project of recentProjects(); track project.id) {
                <div class="project-item">
                  <div class="project-icon">
                    <mat-icon>folder</mat-icon>
                  </div>
                  <div class="project-details">
                    <span class="project-name">{{ project.name }}</span>
                    <span class="project-meta">{{ project.description || 'אין תיאור' }}</span>
                  </div>
                </div>
              }
            </div>
          } @else {
            <div class="empty-state">
              <mat-icon>folder_open</mat-icon>
              <p>אין פרויקטים להצגה</p>
            </div>
          }
        </mat-card-content>
      </mat-card>
    </div>
  }
</div>